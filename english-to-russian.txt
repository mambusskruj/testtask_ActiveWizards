
К счастью, данные находятся в простом формате CSV, и для использования со Spark MLlib не требуется дополнительная обработка и подготовка данных. Позже можно будет попробовать трансформировать эти данные, но для старта используем данные “как есть”. Файл covtype.data должен быть извлечён и скопирован в HDFS. Предполагается, что файл будет доступен по адресу /user/ds/. Открываем spark-shell.
Абстракция SparkMLlib для вектора признаков является LabeledPoint, который состоит из Spark MLlib Vector признаков и значения - меткой. Типом значения является Double, а Vector , по сути, абстракция поверх значений типа Double. Поэтому предполагается, что LabeledPoint нужно использовать только для числовых признаков. LabeledPoint может использоваться с категориальными признаками с соответствующей кодировкой.
Одной из таких кодировок является однократная или 1-из-n кодировка, в которой один категориальный признак принимает N различных значений переходя в N числовых признаков, каждый из которых принимает 0 или 1. Например, категориальный признак погоды, которая может быть облачной, дождливой или ясной, станет тремя числовыми признаками, где облачная погода представлена 1,0,0; дождливая - 0,1,0; и так далее. Эти трёх числовые признаки можно рассматривать как is_cloudy, is_rainy, is_clear. Другая возможная кодировка просто назначает отдельное числовое значение для каждого возможного значения категориальных признаков. К примеру, облачность может быть представлена как 1.0, дождливость 2.0, и так далее.
